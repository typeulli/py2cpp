<!DOCTYPE html>
<html>
<head>
    <title>Python to C++ Converter</title>
    <style>
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            margin: 0; 
            padding: 40px;
            background-color: #f0f8ff;
            color: #2c3e50;
        }
        h2 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: #1e88e5;
            text-align: center;
        }
        h3 {
            font-size: 1.5rem;
            color: #0277bd;
            margin-bottom: 0.8rem;
        }
        #container { 
            display: flex; 
            gap: 30px; 
            margin-top: 30px;
        }
        .editor { 
            width: 45vw; 
            height: 60vh; 
            border: none;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        #controls { 
            margin-top: 30px; 
            text-align: center;
        }
        .option {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-right: 16px;
            font-size: 1rem;
            color: #2c3e50;
        }
        button {
            background-color: #2196f3;
            color: white;
            border: none;
            padding: 12px 28px;
            font-size: 1.1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        button:hover {
            background-color: #0d8aee;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs/loader.js"></script>
</head>
<body>
    <h2>Python to C++ Converter</h2>
    <div id="container">
        <div>
            <h3>Python</h3>
            <div id="py-editor" class="editor"></div>
        </div>
        <div>
            <h3>C++</h3>
            <div id="cpp-editor" class="editor"></div>
        </div>
    </div>
    <div id="controls">
        <label class="option">
            <input type="checkbox" id="use-py2cpp" checked>
            Use py2cpp header
        </label>
        <button onclick="convertCode()">Convert</button>
    </div>
    <script>
            const DEFAULT_PYTHON_CODE = `@c_struct
class fiboset:
    a: c_ulonglong
    b: c_ulonglong

def get_fibonacci(n: int) -> c_ulonglong:
    l = fiboset()
    l.a = c_static_cast("c_ulonglong", 0)
    l.b = c_static_cast("c_ulonglong", 1)
    for _ in range(n):
        l2 = fiboset()
        l2.a = l.b
        l2.b = l.a + l.b
        l = l2
    return l.a

with c_global():
    prompt = "input fibonacci index: "

def run() -> c_void:
    while True:
        s = input(prompt)
        if s == "exit":
            return void
        print(get_fibonacci(int(s)))

run()`;
            const DEFAULT_CPP_CODE = `#include <iostream>
#include <string>

struct fiboset {
    unsigned long long a;
    unsigned long long b;
};

std::string prompt = "input fibonacci index: ";

unsigned long long get_fibonacci(long n) {
    fiboset l = fiboset();
    l.a = static_cast<unsigned long long>(0);
    l.b = static_cast<unsigned long long>(1);
    for (long _ = 0; _ < n; ++_) {
        fiboset l2 = fiboset();
        l2.a = l.b;
        l2.b = l.a + l.b;
        l = l2;
    }
    return l.a;
}

void run() {
    while (true) {
        std::cout << prompt;
        std::string w_0KFvdk;
        std::getline(std::cin, w_0KFvdk);
        std::string s = w_0KFvdk;
        if (s == "exit") {
            return;
        }
        std::cout << get_fibonacci(std::stol(s)) << std::endl;
    }
}

int main() {
    run();
    return 0;
}`


        var pyEditor, cppEditor;
        require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs' }}); 
        require(['vs/editor/editor.main'], function() {
            pyEditor = monaco.editor.create(document.getElementById('py-editor'), {
                value: DEFAULT_PYTHON_CODE,
                language: 'python',
                theme: 'vs-dark'
            });
            cppEditor = monaco.editor.create(document.getElementById('cpp-editor'), {
                value: DEFAULT_CPP_CODE,
                language: 'cpp',
                theme: 'vs-dark',
                readOnly: true
            });
        });

        function convertCode() {
            const useHeader = document.getElementById('use-py2cpp');
            let code = pyEditor.getValue();

            // If checkbox is checked, prepend header lines unless they already exist.
            if (useHeader && useHeader.checked) {
                const hasFrom = /from\s+py2cpp_header\s+import\s+\*/.test(code);
                const hasImport = /import\s+py2cpp_header/.test(code);
                let header = '';
                if (!hasFrom) header += 'from py2cpp_header import *\n';
                if (!hasImport) header += 'import py2cpp_header\n';
                if (header) code = header + '\n' + code;
            }

            fetch('/py2cpp/convert', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ code: code })
            })
            .then(response => response.json())
            .then(data => {
                cppEditor.setValue(data.cpp_code || '// Conversion failed' + (data.error ? `\n// Error: ${data.error}` : ''));
            })
            .catch(error => {
                if (error.message === 'Failed to fetch') {
                    cppEditor.setValue('// Connection error: Is the server running?');
                    return;
                }
                cppEditor.setValue('// Error during conversion');
            });
        }

    </script>
</body>
</html>